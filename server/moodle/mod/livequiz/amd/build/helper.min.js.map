{"version":3,"file":"helper.min.js","sources":["../src/helper.js"],"sourcesContent":["import Templates from \"core/templates\";\r\nimport { exception as displayException } from \"core/notification\";\r\n\r\nlet IDs = 0;\r\nlet isEditing = false;\r\nlet editingIndex = 0;\r\n\r\n/**\r\n * Adds an event listener to the \"Add Answer\" button.\r\n * When the button is clicked, it appends a new answer input field.\r\n */\r\nexport const add_answer_button_event_listener = () => {\r\n  //Adding event listerner to add answer button\r\n  let answer_button = document.querySelector(\".add_new_answer_to_question\");\r\n  answer_button.addEventListener(\"click\", () => {\r\n    append_answer_input();\r\n  });\r\n};\r\n\r\n/**\r\n * Appends a new answer input container to the container holding all answers\r\n * \r\n * This function creates a new answer container with an incremented ID and appends it to the \r\n * element with the class \"all_answers_for_question_div\".\r\n */\r\nexport function append_answer_input() {\r\n  let answer_container = create_answer_container(IDs + 1);\r\n  let parent_element = document.querySelector(\".all_answers_for_question_div\");\r\n  parent_element.appendChild(answer_container);\r\n  IDs++;\r\n}\r\n\r\n/**\r\n * Creates a new answer container element.\r\n * THIS SHOULD PROBABLY BE MADE INTO MUSTACHE TEMPLATE INSTEAD OF A FUNCTION\r\n *\r\n * @param {string} id - The unique identifier for the answer container.\r\n * @returns {HTMLDivElement} The created answer container element.\r\n */\r\nexport function create_answer_container(id) {\r\n  let answer_container = document.createElement(\"div\");\r\n  answer_container.className = \"container_for_new_answer\";\r\n\r\n  let answer_input = document.createElement(\"input\");\r\n  answer_input.className = \"answer_input\";\r\n  answer_input.placeholder = \"Enter answer\";\r\n  answer_input.id = \"answer_input_\" + id;\r\n  answer_input.setAttribute(\"required\", true);\r\n\r\n  let answer_checkbox = document.createElement(\"input\");\r\n  answer_checkbox.setAttribute(\"type\", \"checkbox\");\r\n  answer_checkbox.className = \"answer_checkbox\";\r\n  answer_checkbox.id = \"answer_checkbox_\" + id;\r\n\r\n  let delete_answer_button = create_element(\r\n    \"delete_answer_button\",\r\n    \"button\",\r\n    \"delete_answer_button\",\r\n    \"X\"\r\n  );\r\n  delete_answer_button.id = \"delete_answer_button_\" + id;\r\n\r\n  answer_container.appendChild(answer_checkbox);\r\n  answer_container.appendChild(answer_input);\r\n  answer_container.appendChild(delete_answer_button);\r\n\r\n  delete_answer_button.addEventListener(\"click\", () => {\r\n    answer_container.remove();\r\n  });\r\n  return answer_container;\r\n}\r\n\r\n/**\r\n * Adds an event listener to the discard question button.\r\n * When the button is clicked, it triggers the render_question_confirmation function.\r\n */\r\nexport const add_discard_question_button_listener = () => {\r\n  let discard_question_button = document.querySelector(\r\n    \".discard_question_button\"\r\n  );\r\n  discard_question_button.addEventListener(\"click\", () => {\r\n    render_question_confirmation();\r\n  });\r\n};\r\n\r\n/**\r\n * Renders the question confirmation modal.\r\n *\r\n * Renders \"mod_livequiz/question_confirmation\" template.\r\n * Appends the HTML and JavaScript to the \".Modal_div\" element\r\n * Calls the `question_confirmation` function\r\n *\r\n * @function\r\n * @returns {void}\r\n */\r\nfunction render_question_confirmation() {\r\n  Templates.renderForPromise(\"mod_livequiz/question_confirmation\")\r\n\r\n    .then(({ html, js }) => {\r\n      Templates.appendNodeContents(\".Modal_div\", html, js);\r\n      question_confirmation();\r\n    })\r\n    .catch((error) => displayException(error));\r\n}\r\n\r\n/**\r\n * Handles the confirmation process for deleting a question.\r\n * \r\n * This function sets up event listeners for the yes and no buttons when discarding a question.\r\n * When yes is clicked, the editing menu is removed\r\n * When no is clicked, the confirmation pop-up is removed\r\n * \r\n * @function question_confirmation\r\n */\r\nfunction question_confirmation() {\r\n  let toast_promise_deletion_div = document.querySelector(\r\n    \".toast_promise_deletion_div\"\r\n  );\r\n  let cancel_question_deletion_button = document.querySelector(\r\n    \".cancel_question_deletion_button\"\r\n  );\r\n  let continue_question_deletion_button = document.querySelector(\r\n    \".continue_question_deletion_button\"\r\n  );\r\n\r\n  let modal_div = document.querySelector(\".Modal_div\");\r\n\r\n  continue_question_deletion_button.addEventListener(\"click\", () => {\r\n    isEditing = false;\r\n    editingIndex = null;\r\n    modal_div.remove();\r\n  });\r\n\r\n  cancel_question_deletion_button.addEventListener(\"click\", () => {\r\n    toast_promise_deletion_div.remove();\r\n  });\r\n}\r\n\r\n/**\r\n * Creates a new HTML element with the specified type, class, and content.\r\n *\r\n * @param {HTMLElement} element_name - The variable to hold the created element.\r\n * @param {string} type - The type of the HTML element to create (e.g., 'div', 'span').\r\n * @param {string} class_name - The class name to assign to the created element.\r\n * @param {string} content - The text content to set for the created element.\r\n * @returns {HTMLElement} The newly created HTML element.\r\n */\r\nfunction create_element(element_name, type, class_name, content) {\r\n  element_name = document.createElement(type);\r\n  element_name.className = class_name;\r\n  element_name.textContent = content;\r\n  return element_name;\r\n}\r\n\r\n/**\r\n * Rerenders the saved questions list.\r\n *\r\n * This function removes the existing saved questions list from the DOM,\r\n * Renders the \"mod_livequiz/saved_questions_list\" template with the provided questions\r\n * After re-rendering, it calls the provided callback function, if any.\r\n *\r\n * @param {Array} questions - An array of question objects to be rendered.\r\n * @param {Function} [callback] - An optional callback function to be executed after the list is re-rendered.\r\n */\r\nexport function rerender_saved_questions_list(questions, callback) {\r\n  //The template needs to know the questions to render.\r\n  const contextsavedquestions = {\r\n    questions: questions,\r\n  };\r\n\r\n  //Remove the saved questions list.\r\n  let questions_list = document.querySelector(\"#saved_questions_list\");\r\n  questions_list.remove();\r\n\r\n  //Re-render saved questions list.\r\n  Templates.renderForPromise(\r\n    \"mod_livequiz/saved_questions_list\",\r\n    contextsavedquestions\r\n  )\r\n    .then(({ html, js }) => {\r\n      Templates.appendNodeContents(\"#saved-questions-container\", html, js);\r\n\r\n      //Call the functions in callback, this allows for custom functions to be called after the rerendering.\r\n      if (typeof callback === \"function\") {\r\n        callback();\r\n      }\r\n    })\r\n    .catch((error) => displayException(error));\r\n}\r\n\r\n/**\r\n * Renders the \"mod_livequiz/take_quiz_button\" template based on whether there are questions in the quiz.\r\n *\r\n * @param {string} url - The URL for the \"Take Quiz\" button to redirect to.\r\n * @param {boolean} hasquestions - Indicates if the quiz has questions.\r\n * @param {function} [callback] - Optional callback function to execute after re-rendering.\r\n */\r\n\r\nexport function rerender_take_quiz_button(url, hasquestions, callback) {\r\n  //The template needs to know if there are questions in the quiz.\r\n  //If there are questions -> Create a button to redirect to the quiz.\r\n  //If there are no questions -> Display a paragraph that says there are no questions.\r\n\r\n  const contexttakequiz = {\r\n    url: url,\r\n    hasquestions: hasquestions,\r\n  };\r\n\r\n  if (hasquestions) {\r\n    //Remove no question paragraph if there are questions.\r\n    let no_question_paragraph = document.querySelector(\".no-question-text\");\r\n    no_question_paragraph.remove(); //We have just added a question so remove the no question text\r\n  } else {\r\n    //Remove take quiz link if there are no questions\r\n    let take_quiz_button = document.querySelector(\"#takeQuizBtn\");\r\n    console.log(take_quiz_button);\r\n    take_quiz_button.remove();\r\n  }\r\n\r\n  Templates.renderForPromise(\"mod_livequiz/take_quiz_button\", contexttakequiz)\r\n    // It returns a promise that needs to be resoved.\r\n    .then(({ html, js }) => {\r\n      // Here we have compiled template.\r\n      Templates.appendNodeContents(\"#page-mod-livequiz-quizcreator\", html, js);\r\n      if (typeof callback === \"function\") {\r\n        callback();\r\n      }\r\n    })\r\n\r\n    // Deal with this exception (Using core/notify exception function is recommended).\r\n    .catch((error) => displayException(error));\r\n}\r\n"],"names":["questions","callback","contextsavedquestions","document","querySelector","remove","renderForPromise","then","_ref2","html","js","appendNodeContents","catch","error","url","hasquestions","contexttakequiz","take_quiz_button","console","log","_ref3","IDs","isEditing","editingIndex","append_answer_input","answer_container","create_answer_container","appendChild","id","createElement","className","answer_input","placeholder","setAttribute","answer_checkbox","delete_answer_button","element_name","type","class_name","content","textContent","addEventListener","_ref","toast_promise_deletion_div","cancel_question_deletion_button","continue_question_deletion_button","modal_div","question_confirmation"],"mappings":"obAoK8CA,UAAWC,gBAEjDC,sBAAwB,CAC5BF,UAAWA,WAIQG,SAASC,cAAc,yBAC7BC,4BAGLC,iBACR,oCACAJ,uBAECK,MAAKC,YAACC,KAAEA,KAAFC,GAAQA,6BACHC,mBAAmB,6BAA8BF,KAAMC,IAGzC,mBAAbT,UACTA,cAGHW,OAAOC,QAAU,2BAAiBA,sDAWGC,IAAKC,aAAcd,gBAKrDe,gBAAkB,CACtBF,IAAKA,IACLC,aAAcA,iBAGZA,aAAc,CAEYZ,SAASC,cAAc,qBAC7BC,aACjB,KAEDY,iBAAmBd,SAASC,cAAc,gBAC9Cc,QAAQC,IAAIF,kBACZA,iBAAiBZ,4BAGTC,iBAAiB,gCAAiCU,iBAEzDT,MAAKa,YAACX,KAAEA,KAAFC,GAAQA,6BAEHC,mBAAmB,iCAAkCF,KAAMC,IAC7C,mBAAbT,UACTA,cAKHW,OAAOC,QAAU,2BAAiBA,4EAnOnCQ,IAAM,EACNC,WAAY,EACZC,aAAe,WAoBHC,0BACVC,iBAAmBC,wBAAwBL,IAAM,GAChClB,SAASC,cAAc,iCAC7BuB,YAAYF,kBAC3BJ,eAUcK,wBAAwBE,QAClCH,iBAAmBtB,SAAS0B,cAAc,OAC9CJ,iBAAiBK,UAAY,+BAEzBC,aAAe5B,SAAS0B,cAAc,SAC1CE,aAAaD,UAAY,eACzBC,aAAaC,YAAc,eAC3BD,aAAaH,GAAK,gBAAkBA,GACpCG,aAAaE,aAAa,YAAY,OAElCC,gBAAkB/B,SAAS0B,cAAc,SAC7CK,gBAAgBD,aAAa,OAAQ,YACrCC,gBAAgBJ,UAAY,kBAC5BI,gBAAgBN,GAAK,mBAAqBA,OAEtCO,sBA6FkBC,aA5FpB,uBA4FkCC,KA3FlC,SA2FwCC,WA1FxC,uBA0FoDC,QAzFpD,KA0FFH,aAAejC,SAAS0B,cAAcQ,OACzBP,UAAYQ,WACzBF,aAAaI,YAAcD,QACpBH,kBAJeA,aAAcC,KAAMC,WAAYC,eAvFtDJ,qBAAqBP,GAAK,wBAA0BA,GAEpDH,iBAAiBE,YAAYO,iBAC7BT,iBAAiBE,YAAYI,cAC7BN,iBAAiBE,YAAYQ,sBAE7BA,qBAAqBM,iBAAiB,SAAS,KAC7ChB,iBAAiBpB,YAEZoB,2DA1DuC,KAE1BtB,SAASC,cAAc,+BAC7BqC,iBAAiB,SAAS,KACtCjB,wEA6DgD,KACpBrB,SAASC,cACrC,4BAEsBqC,iBAAiB,SAAS,wBAgBxCnC,iBAAiB,sCAExBC,MAAKmC,WAACjC,KAAEA,KAAFC,GAAQA,4BACHC,mBAAmB,aAAcF,KAAMC,mBAgBjDiC,2BAA6BxC,SAASC,cACxC,+BAEEwC,gCAAkCzC,SAASC,cAC7C,oCAEEyC,kCAAoC1C,SAASC,cAC/C,sCAGE0C,UAAY3C,SAASC,cAAc,cAEvCyC,kCAAkCJ,iBAAiB,SAAS,KAC1DnB,WAAY,EACZC,aAAe,KACfuB,UAAUzC,YAGZuC,gCAAgCH,iBAAiB,SAAS,KACxDE,2BAA2BtC,YAlCzB0C,MAEDnC,OAAOC,QAAU,2BAAiBA"}