{"version":3,"file":"student_join_quiz.min.js","sources":["../src/student_join_quiz.js"],"sourcesContent":["/* eslint-disable no-console */\n// Define and export the init function\nexport const init = (url, studentid) => {\n    console.log(\"Student Script is loaded and attempting to attach event listener.\");\n\n    const roomConnectionBtn = document.getElementById(\"room_connection_button\");\n    if (!roomConnectionBtn) {\n        console.error(\"Button with id 'room_connection_button' not found!\");\n        return;\n    }\n\n    let roomCodeInput = document.getElementById(\"roomCode\");\n    if (!roomCodeInput) {\n        console.error(\"Field with id 'roomCodeInput' not found!\");\n        return;\n    }\n\n    let socket;\n    // Sends message to socket when startQuiz button is pressed\n    roomConnectionBtn.addEventListener(\"click\", async () => {\n        roomCodeInput = roomCodeInput.value;\n        if (roomCodeInput === null || roomCodeInput.trim() == \"\") {\n            console.error(\"No room code found.\");\n            return;\n        }\n\n        try {\n            console.log(\"sending message\"); // eslint-disable-line no-console\n            socket = await connect_to_socket(`${url}?requesttype=connect&userid=${studentid}&room=${roomCodeInput}`);\n            socket.send(\"Testing some stuff for students\" + ' ' + `${studentid}`);\n        } catch (e) {\n            console.error(`Student failed to join room, ${e}`);\n        }\n    });\n\n    const leaveRoomBtn = document.getElementById(\"leave_room_button\");\n\n    if (!leaveRoomBtn) {\n        console.error(\"Button with id 'leave_room_button' not found!\");\n        return;\n    }\n\n    // Sends message to socket when startQuiz button is pressed\n    leaveRoomBtn.addEventListener(\"click\", async () => {\n        const requesttype = \"leaveroom\";\n\n        let leave_room_request = {\n            roomCodeInput,\n            requesttype,\n            studentid,\n        };\n        console.log(\"Leave room request:\", JSON.stringify(leave_room_request));\n        try {\n            console.log(requesttype);\n            console.log(\"sending message\"); // eslint-disable-line no-console\n            socket.send(JSON.stringify(leave_room_request));\n            socket.onclose();\n        } catch (e) {\n            console.error(`Student failed to leave room, ${e}`);\n        }\n    });\n\n};\n\n\n/**\n * Connects a websocket given url\n *\n * @param {string} url\n * @returns websocket reference\n */\nasync function connect_to_socket(url) {\n    let socket;\n    socket = new WebSocket(url);\n    let myPromise = new Promise(function (myResolve, myReject) {\n        socket.onopen = () => {\n            console.log(\"WebSocket connection established successfully!\");\n            myResolve(socket);\n        };\n        // Handle errors\n        socket.onerror = (error) => {\n            console.error(\"WebSocket encountered an error:\", error);\n            myReject();\n        };\n        console.log(\"WebSocket object created, awaiting connection.\");\n        // Handle incoming messages\n        socket.onmessage = (event) => {\n            console.log(\"WebSocket message received:\", event.data);\n        };\n        // Handle connection close\n        socket.onclose = () => {\n            console.log(\"WebSocket connection closed.\");\n        };\n    });\n    return myPromise;\n}"],"names":["url","studentid","console","log","roomConnectionBtn","document","getElementById","error","socket","roomCodeInput","addEventListener","async","value","trim","WebSocket","Promise","myResolve","myReject","onopen","onerror","onmessage","event","data","onclose","connect_to_socket","send","e","leaveRoomBtn","leave_room_request","requesttype","JSON","stringify"],"mappings":"mKAEoB,CAACA,IAAKC,aACtBC,QAAQC,IAAI,2EAENC,kBAAoBC,SAASC,eAAe,8BAC7CF,8BACDF,QAAQK,MAAM,0DAUdC,OANAC,cAAgBJ,SAASC,eAAe,gBACvCG,0BACDP,QAAQK,MAAM,4CAMlBH,kBAAkBM,iBAAiB,SAASC,aACxCF,cAAgBA,cAAcG,MACR,OAAlBH,eAAkD,IAAxBA,cAAcI,WAMxCX,QAAQC,IAAI,mBACZK,4BA2CqBR,SACzBQ,cACJA,OAAS,IAAIM,UAAUd,KACP,IAAIe,SAAQ,SAAUC,UAAWC,UAC7CT,OAAOU,OAAS,KACZhB,QAAQC,IAAI,kDACZa,UAAUR,SAGdA,OAAOW,QAAWZ,QACdL,QAAQK,MAAM,kCAAmCA,OACjDU,YAEJf,QAAQC,IAAI,kDAEZK,OAAOY,UAAaC,QAChBnB,QAAQC,IAAI,8BAA+BkB,MAAMC,OAGrDd,OAAOe,QAAU,KACbrB,QAAQC,IAAI,oCA/DGqB,WAAqBxB,2CAAkCC,2BAAkBQ,gBACxFD,OAAOiB,KAAK,6CAA6CxB,YAC3D,MAAOyB,GACLxB,QAAQK,6CAAsCmB,SAT9CxB,QAAQK,MAAM,gCAahBoB,aAAetB,SAASC,eAAe,qBAExCqB,aAMLA,aAAajB,iBAAiB,SAASC,cAG/BiB,mBAAqB,CACrBnB,cAAAA,cACAoB,YAJgB,YAKhB5B,UAAAA,WAEJC,QAAQC,IAAI,sBAAuB2B,KAAKC,UAAUH,yBAE9C1B,QAAQC,IATQ,aAUhBD,QAAQC,IAAI,mBACZK,OAAOiB,KAAKK,KAAKC,UAAUH,qBAC3BpB,OAAOe,UACT,MAAOG,GACLxB,QAAQK,8CAAuCmB,QApBnDxB,QAAQK,MAAM"}