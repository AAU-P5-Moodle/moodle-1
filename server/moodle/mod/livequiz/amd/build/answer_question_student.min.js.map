{"version":3,"file":"answer_question_student.min.js","sources":["../src/answer_question_student.js"],"sourcesContent":["/* eslint-disable no-console */\n// Define and export the init function\nexport const init = (url, studentid) => {\n    console.log(\"Initializing quiz interaction.\");\n\n    const nextQuestionBtn = document.getElementById(\"nextButton\");\n    if (!nextQuestionBtn) {\n        console.error(`Next button not found!`);\n        return;\n    }\n\n    const quizid = document.getElementsByName(\"quizid\")[0].value;\n    const cmid = document.getElementsByName(\"cmid\")[0].value;\n    const questionid = document.getElementsByName(\"questionid\")[0].value;\n\n    if (!quizid || !cmid || !questionid) {\n        console.error(`Buttons with id 'quizid', 'cmid', 'questionid' not found!`);\n        return;\n    }\n\n    nextQuestionBtn.addEventListener(\"click\", async () => {\n        const socket = await connect_to_socket(`${url}?requesttype=nextquestion&userid=${studentid}`);\n        console.log(\"Preparing to send data.\");\n\n        const answerElement = document.querySelectorAll(\".answer input\");\n        if (!answerElement) {\n            console.error(\"Answer id does not exists\");\n        }\n\n        let idOfAnswers = Array.from(answerElement).filter((answer) => answer.checked).map((answer) => answer.value);\n\n        const questiondata = {\n            quizid,\n            cmid,\n            questionid,\n            idOfAnswers,\n        };\n\n        try {\n            if (!socket || socket.readyState !== WebSocket.OPEN) {\n                console.log(\"Not ready to send data.\");\n            }\n            console.log(\"sending message\"); // eslint-disable-line no-console\n            const message = JSON.stringify(questiondata);\n            socket.send(message);\n        } catch (e) {\n            console.error(`Failed to send data of answer, ${e}`);\n        }\n    });\n};\n\n\n/**\n * Connects a websocket given url\n *\n * @param {string} url\n * @returns websocket reference\n */\nfunction connect_to_socket(url) {\n    let socket;\n    socket = new WebSocket(url);\n    let myPromise = new Promise(function (myResolve, myReject) {\n        socket.onopen = () => {\n            console.log(\"WebSocket connection established successfully!\");\n            myResolve(socket);\n        };\n        // Handle errors\n        socket.onerror = (error) => {\n            console.error(\"WebSocket encountered an error:\", error);\n            myReject();\n        };\n        console.log(\"WebSocket object created, awaiting connection.\");\n        // Handle incoming messages\n        socket.onmessage = (event) => {\n            console.log(\"WebSocket message received:\", event.data);\n\n        };\n        // Handle connection close\n        socket.onclose = () => {\n            console.log(\"WebSocket connection closed.\");\n        };\n    });\n    return myPromise;\n}"],"names":["url","studentid","console","log","nextQuestionBtn","document","getElementById","error","quizid","getElementsByName","value","cmid","questionid","addEventListener","async","socket","WebSocket","Promise","myResolve","myReject","onopen","onerror","onmessage","event","data","onclose","connect_to_socket","answerElement","querySelectorAll","idOfAnswers","Array","from","filter","answer","checked","map","questiondata","readyState","OPEN","message","JSON","stringify","send","e"],"mappings":"yKAEoB,CAACA,IAAKC,aACtBC,QAAQC,IAAI,wCAENC,gBAAkBC,SAASC,eAAe,kBAC3CF,4BACDF,QAAQK,sCAINC,OAASH,SAASI,kBAAkB,UAAU,GAAGC,MACjDC,KAAON,SAASI,kBAAkB,QAAQ,GAAGC,MAC7CE,WAAaP,SAASI,kBAAkB,cAAc,GAAGC,MAE1DF,QAAWG,MAASC,WAKzBR,gBAAgBS,iBAAiB,SAASC,gBAChCC,sBAqCaf,SACnBe,cACJA,OAAS,IAAIC,UAAUhB,KACP,IAAIiB,SAAQ,SAAUC,UAAWC,UAC7CJ,OAAOK,OAAS,KACZlB,QAAQC,IAAI,kDACZe,UAAUH,SAGdA,OAAOM,QAAWd,QACdL,QAAQK,MAAM,kCAAmCA,OACjDY,YAEJjB,QAAQC,IAAI,kDAEZY,OAAOO,UAAaC,QAChBrB,QAAQC,IAAI,8BAA+BoB,MAAMC,OAIrDT,OAAOU,QAAU,KACbvB,QAAQC,IAAI,oCA1DKuB,WAAqB1B,gDAAuCC,YACjFC,QAAQC,IAAI,iCAENwB,cAAgBtB,SAASuB,iBAAiB,iBAC3CD,eACDzB,QAAQK,MAAM,iCAGdsB,YAAcC,MAAMC,KAAKJ,eAAeK,QAAQC,QAAWA,OAAOC,UAASC,KAAKF,QAAWA,OAAOvB,cAEhG0B,aAAe,CACjB5B,OAAAA,OACAG,KAAAA,KACAC,WAAAA,WACAiB,YAAAA,iBAIKd,QAAUA,OAAOsB,aAAerB,UAAUsB,MAC3CpC,QAAQC,IAAI,2BAEhBD,QAAQC,IAAI,yBACNoC,QAAUC,KAAKC,UAAUL,cAC/BrB,OAAO2B,KAAKH,SACd,MAAOI,GACLzC,QAAQK,+CAAwCoC,QA9BpDzC,QAAQK"}