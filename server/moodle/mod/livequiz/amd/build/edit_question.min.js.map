{"version":3,"file":"edit_question.min.js","sources":["../src/edit_question.js"],"sourcesContent":["import Templates from \"core/templates\";\nimport { exception as displayException } from \"core/notification\";\nimport { save_question } from \"./repository\";\nimport {add_answer_button_event_listener, add_discard_question_button_listener} from \"./edit_question_helper\";\n\nexport const init = async (quizid, lecturerid) => {\n    let question_list = document.getElementById(\"saved_questions_list\");\n    let edit_question_elements = question_list.querySelectorAll(\".edit-question\");\n    edit_question_elements.forEach((element) => {\n        let questionid = element.dataset.id;\n        element.addEventListener(\"click\", () => {\n            render_edit_question_menu_popup(quizid, lecturerid, questionid);\n        });\n    });\n};\n\n\nfunction render_edit_question_menu_popup(quizid, lecturerid, questionid) {\n    // This will call the function to load and render our template.\n    Templates.renderForPromise(\"mod_livequiz/question_menu_popup\")\n\n        // It returns a promise that needs to be resolved.\n        .then(({ html, js }) => {\n            // Here we have the compiled template.\n            Templates.appendNodeContents(\".main-container\", html, js);\n            add_answer_button_event_listener();\n            add_save_question_button_listener(quizid, lecturerid, questionid);\n            add_discard_question_button_listener();\n        })\n\n        // Deal with this exception (Using core/notify exception function is recommended).\n        .catch((error) => displayException(error));\n}\n\nfunction add_save_question_button_listener(quizid, lecturerid, questionid) {\n    let save_question_button = document.querySelector(\".save_button\");\n    save_question_button.addEventListener(\"click\", () => {\n        on_save_question_button_clicked(quizid, lecturerid, questionid);\n    });\n}\n\nfunction on_save_question_button_clicked(quizid, lecturerid, questionid) {\n    let question_input_title = document.getElementById(\"question_title_id\");\n    let question_indput_description = document.getElementById(\"question_description_id\");\n    let question_indput_explanation = document.getElementById(\"question_explanation_id\");\n    let questionTitle = question_input_title.value.trim();\n    let questionDesription = question_indput_description.value.trim();\n    let questionExplanation = question_indput_explanation.value.trim();\n\n    if (!questionDesription) {\n        alert(\"Please enter a question description.\");\n        return;\n    }\n    if(!questionTitle){\n        questionTitle = \"Question\";\n    }\n    let answers = [];\n    let answers_div = document.querySelector(\".all_answers_for_question_div\");\n    for (let i = 0; i < answers_div.children.length; i++) {\n        let answertext = answers_div.children[i]\n            .querySelector(\".answer_input\")\n            .value.trim();\n\n        let iscorrect =\n            answers_div.children[i].querySelector(\".answer_checkbox\").checked;\n        iscorrect ? (iscorrect = 1) : (iscorrect = 0);\n\n        answers.push({\n            description: answertext,\n            correct: iscorrect,\n            explanation: \"\",\n        });\n    }\n\n    let savedQuestion = {\n        id: questionid,\n        title: questionTitle,\n        answers: answers,\n        description: questionDesription,\n        explanation: questionExplanation,\n    };\n    save_question(savedQuestion, lecturerid, quizid).then((questions) => {\n        const contextsavedquestions = {\n            questions: questions,\n        };\n\n        //Remove the saved questions list and take quiz button\n        let questions_list = document.querySelector(\"#saved_questions_list\");\n        questions_list.remove();\n\n        Templates.renderForPromise(\n            \"mod_livequiz/saved_questions_list\",\n            contextsavedquestions\n        )\n            // It returns a promise that needs to be resoved.\n            .then(({ html, js }) => {\n                // Here eventually I have my compiled template, and any javascript that it generated.\n                // The templates object has append, prepend and replace functions.\n                Templates.appendNodeContents(\"#saved-questions-container\", html, js);\n            })\n\n            // Deal with this exception (Using core/notify exception function is recommended).\n            .catch((error) => displayException(error));\n\n\n    });\n    let modal_div = document.querySelector(\".Modal_div\");\n    modal_div.remove();\n}\n\n\n\n\n\n"],"names":["async","quizid","lecturerid","document","getElementById","querySelectorAll","forEach","element","questionid","dataset","id","addEventListener","renderForPromise","then","_ref","html","js","appendNodeContents","querySelector","question_input_title","question_indput_description","question_indput_explanation","questionTitle","value","trim","questionDesription","questionExplanation","alert","answers","answers_div","i","children","length","answertext","iscorrect","checked","push","description","correct","explanation","savedQuestion","title","questions","contextsavedquestions","remove","_ref2","catch","error","on_save_question_button_clicked","add_save_question_button_listener","render_edit_question_menu_popup"],"mappings":"6WAKoBA,MAAOC,OAAQC,cACXC,SAASC,eAAe,wBACDC,iBAAiB,kBACrCC,SAASC,cACxBC,WAAaD,QAAQE,QAAQC,GACjCH,QAAQI,iBAAiB,SAAS,eAODV,OAAQC,WAAYM,+BAE/CI,iBAAiB,oCAGtBC,MAAKC,WAACC,KAAEA,KAAFC,GAAQA,4BAEDC,mBAAmB,kBAAmBF,KAAMC,0EAUvBf,OAAQC,WAAYM,YAChCL,SAASe,cAAc,gBAC7BP,iBAAiB,SAAS,eAKVV,OAAQC,WAAYM,gBACrDW,qBAAuBhB,SAASC,eAAe,qBAC/CgB,4BAA8BjB,SAASC,eAAe,2BACtDiB,4BAA8BlB,SAASC,eAAe,2BACtDkB,cAAgBH,qBAAqBI,MAAMC,OAC3CC,mBAAqBL,4BAA4BG,MAAMC,OACvDE,oBAAsBL,4BAA4BE,MAAMC,WAEvDC,+BACDE,MAAM,wCAGNL,gBACAA,cAAgB,gBAEhBM,QAAU,GACVC,YAAc1B,SAASe,cAAc,qCACpC,IAAIY,EAAI,EAAGA,EAAID,YAAYE,SAASC,OAAQF,IAAK,KAC9CG,WAAaJ,YAAYE,SAASD,GACjCZ,cAAc,iBACdK,MAAMC,OAEPU,UACAL,YAAYE,SAASD,GAAGZ,cAAc,oBAAoBiB,QACjDD,UAAbA,UAAyB,EAAkB,EAE3CN,QAAQQ,KAAK,CACTC,YAAaJ,WACbK,QAASJ,UACTK,YAAa,SAIjBC,cAAgB,CAChB9B,GAAIF,WACJiC,MAAOnB,cACPM,QAASA,QACTS,YAAaZ,mBACbc,YAAab,mDAEHc,cAAetC,WAAYD,QAAQY,MAAM6B,kBAC7CC,sBAAwB,CAC1BD,UAAWA,WAIMvC,SAASe,cAAc,yBAC7B0B,4BAELhC,iBACN,oCACA+B,uBAGC9B,MAAKgC,YAAC9B,KAAEA,KAAFC,GAAQA,6BAGDC,mBAAmB,6BAA8BF,KAAMC,OAIpE8B,OAAOC,QAAU,2BAAiBA,YAI3B5C,SAASe,cAAc,cAC7B0B,SAtENI,CAAgC/C,OAAQC,WAAYM,eAXhDyC,CAAkChD,OAAQC,WAAYM,gFAKzDsC,OAAOC,QAAU,2BAAiBA,SApB/BG,CAAgCjD,OAAQC,WAAYM"}