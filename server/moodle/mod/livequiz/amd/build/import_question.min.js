define("mod_livequiz/import_question",["exports","core/templates","./edit_question_helper","./edit_question","./delete_question","core/notification","./repository"],(function(_exports,_templates,_edit_question_helper,_edit_question,_delete_question,_notification,_repository){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=async(quizid,lecturerid,url)=>{document.getElementById("id_buttonimportquestion").addEventListener("click",(()=>{!async function(quizid,lecturerid,url){_templates.default.renderForPromise("mod_livequiz/import_question_popup").then((async _ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main-container",html,js),await async function(quizid,url,lecturerid){let quiz_url=url;document.querySelector(".import_btn").addEventListener("click",(async()=>{try{let questionids=function(){let checkedquestions=[],questions_div=document.querySelector(".oldQuizzes");for(let quiz_div of questions_div.children)for(let content of quiz_div.children)if("DIV"===content.tagName)for(let question_div of content.children)for(let children of question_div.children)if("INPUT"===children.tagName){let checkbox=children;checkbox.checked&&checkedquestions.push(parseInt(checkbox.id))}return checkedquestions}();!function(quizid,questionids,lecturerid,quiz_url){(0,_repository.external_reuse_questions)(quizid,questionids,lecturerid).then((questions=>{let update_event_listeners=()=>{(0,_edit_question.add_edit_question_listeners)(quizid,lecturerid),(0,_delete_question.add_delete_question_listeners)(quizid,lecturerid)};(0,_edit_question_helper.rerender_saved_questions_list)(questions,update_event_listeners),(0,_edit_question_helper.rerender_take_quiz_button)(quiz_url,!0)})).catch((error=>console.log(error))),document.querySelector(".Modal_div").remove()}(quizid,questionids,lecturerid,quiz_url)}catch(error){window.console.error("Error in import of questions"),console.log(error)}}))}(quizid,url,lecturerid),(0,_edit_question_helper.add_discard_question_button_listener)(),function(lecturerid,quizid){(0,_repository.get_lecturer_quiz)(lecturerid).then((oldquizzes=>{oldquizzes=oldquizzes.filter((currentquiz=>currentquiz.quizid!==quizid));let oldQuizzesContainer=document.querySelector(".oldQuizzes");if(0===oldquizzes.length){let noQuestions=document.createElement("p");return noQuestions.textContent="No questions available.",void oldQuizzesContainer.appendChild(noQuestions)}oldquizzes.forEach((quiz=>{if(quiz.questions.length>0){let question_checkboxes=[],quiz_div=document.createElement("div"),quiz_checkbox=document.createElement("input");quiz_checkbox.type="checkbox",quiz_checkbox.value=quiz.quizid,quiz_checkbox.id=quiz.quizid,quiz_checkbox.style.marginRight="5px",quiz_checkbox.name=quiz.quiztitle;let quiz_label=document.createElement("label");quiz_label.htmlFor="quiz_".concat(quiz.quizid),quiz_label.textContent=quiz.quiztitle,quiz_label.style.fontWeight="bold",quiz_div.class="oldquiz",quiz_div.appendChild(quiz_checkbox),quiz_div.appendChild(quiz_label),quiz_div.style.border="2px solid black";let questions_div=document.createElement("div");questions_div.style.marginBottom="20px",questions_div.style.marginLeft="20px",questions_div.id="questionsdiv",quiz.questions.forEach((question=>{let question_div=document.createElement("div"),question_checkbox=document.createElement("input");question_checkbox.type="checkbox",question_checkbox.value="question_".concat(question.questionid),question_checkbox.style.marginRight="5px",question_checkbox.id=question.questionid,question_checkbox.name=question.questiontitle,question_checkboxes.push(question_checkbox);let question_label=document.createElement("label");question_label.htmlFor="question_".concat(question.questionid),question_label.textContent=question.questiontitle,question_div.appendChild(question_checkbox),question_div.appendChild(question_label),questions_div.appendChild(question_div)})),questioncheckboxes=question_checkboxes,(checkbox=quiz_checkbox).addEventListener("change",(()=>{questioncheckboxes.forEach((questioncheckbox=>{questioncheckbox.checked=checkbox.checked}))})),function(checkbox,questioncheckboxes){questioncheckboxes.forEach((questioncheckbox=>{questioncheckbox.addEventListener("change",(()=>{if(questioncheckbox.checked){let checkboxes_same=!1;checkboxes_same=questioncheckboxes.every((question=>question.checked)),checkboxes_same&&(checkbox.checked=questioncheckbox.checked)}else checkbox.checked=questioncheckbox.checked}))}))}(quiz_checkbox,question_checkboxes),quiz_div.appendChild(questions_div),oldQuizzesContainer.appendChild(quiz_div)}var checkbox,questioncheckboxes}))})).catch((error=>console.log(error)))}(lecturerid,quizid)})).catch((error=>(0,_notification.displayException)(error)))}(quizid,lecturerid,url)}))}}));

//# sourceMappingURL=import_question.min.js.map