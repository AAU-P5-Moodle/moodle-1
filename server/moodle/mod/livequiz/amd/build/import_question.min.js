define("mod_livequiz/import_question",["exports","core/templates","core/notification","./edit_question_helper","./edit_question","./delete_question","./repository"],(function(_exports,_templates,_notification,_edit_question_helper,_edit_question,_delete_question,_repository){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=async(quizid,lecturerid,url)=>{document.getElementById("id_buttonimportquestion").addEventListener("click",(()=>{!async function(quizid,lecturerid,url){document.querySelector(".Modal_div")||_templates.default.renderForPromise("mod_livequiz/import_question_popup").then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main-container",html,js),function(quizid,url,lecturerid){let quiz_url=url;document.querySelector(".import_btn").addEventListener("click",(async()=>{try{let questionids=function(){let checkedquestions=[],questions_div=document.querySelector(".oldQuizzes");for(let quiz_div of questions_div.children)for(let content of quiz_div.children)if("DIV"===content.tagName)for(let question_div of content.children)for(let children of question_div.children)if("INPUT"===children.tagName){let checkbox=children;checkbox.checked&&checkedquestions.push(parseInt(checkbox.id))}return checkedquestions}();if(0===questionids.length)return void alert("No questions selected. Pleas choose at least one question to import.");!function(quizid,questionids,lecturerid,quiz_url){(0,_repository.external_reuse_questions)(quizid,questionids,lecturerid).then((questions=>{let update_event_listeners=()=>{(0,_edit_question.add_edit_question_listeners)(quizid,lecturerid),(0,_delete_question.add_delete_question_listeners)(quizid,lecturerid)};(0,_edit_question_helper.rerender_saved_questions_list)(questions,update_event_listeners),(0,_edit_question_helper.rerender_take_quiz_button)(quiz_url,!0)})).catch((error=>console.log(error))),document.querySelector(".backdrop").remove()}(quizid,questionids,lecturerid,quiz_url)}catch(error){window.console.error("Error in import of questions"),console.log(error)}}))}(quizid,url,lecturerid),(0,_edit_question_helper.add_cancel_edit_button_listener)("import"),function(lecturerid,quizid){(0,_repository.get_lecturer_quiz)(lecturerid).then((oldquizzes=>{oldquizzes=oldquizzes.filter((currentquiz=>currentquiz.quizid!==quizid));let oldQuizzesContainer=document.querySelector(".oldQuizzes");if(0===oldquizzes.length){let noQuestions=document.createElement("p");return noQuestions.textContent="No questions available.",void oldQuizzesContainer.appendChild(noQuestions)}oldquizzes.forEach((quiz=>{let quiz_context={quizid:quiz.quizid,quiztitle:quiz.quiztitle,questions:quiz.questions};quiz.questions.length>0&&_templates.default.renderForPromise("mod_livequiz/import_questions_list",quiz_context).then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents(".oldQuizzes",html,js),function(quizId){let quizCheckbox=document.querySelector(".quiz_"+quizId),questionCheckboxes=document.querySelectorAll(".quiz_"+quizId+"_question");quizCheckbox.addEventListener("change",(()=>{questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.checked=quizCheckbox.checked}))}))}(quiz.quizid),function(quizId){let quizCheckbox=document.querySelector(".quiz_"+quizId),questionCheckboxes=document.querySelectorAll(".quiz_"+quizId+"_question");console.log(quizCheckbox),console.log(questionCheckboxes),questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.addEventListener("change",(()=>{if(questionCheckbox.checked){let allChecked=!1;questions=questionCheckboxes,console.log(questions),allChecked=Array.from(questions).every((question=>question.checked)),allChecked&&(quizCheckbox.checked=questionCheckbox.checked)}else quizCheckbox.checked=questionCheckbox.checked;var questions}))}))}(quiz.quizid)})).catch((error=>(0,_notification.exception)(error)))}))})).catch((error=>console.log(error)))}(lecturerid,quizid)})).catch((error=>(0,_notification.exception)(error)))}(quizid,lecturerid,url)}))}}));

//# sourceMappingURL=import_question.min.js.map