define("mod_livequiz/import_question",["exports","core/templates","./helper","./edit_question","./delete_question","./repository"],(function(_exports,_templates,_helper,_edit_question,_delete_question,_repository){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=async(quizId,lecturerId,url)=>{document.getElementById("import_question_button").addEventListener("click",(()=>{!async function(quizId,lecturerId,url){_templates.default.renderForPromise("mod_livequiz/import_question_popup",{},"boost").then((async _ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main_container",html,js),await async function(quizId,url,lecturerId){let quizUrl=url;document.querySelector(".import_question_button").addEventListener("click",(async()=>{try{let questionIds=function(){let checkedQuestions=[],questionsDiv=document.querySelector(".old_quizzes");for(let quizDiv of questionsDiv.children)for(let content of quizDiv.children)if("DIV"===content.tagName)for(let questionDiv of content.children)for(let children of questionDiv.children)if("INPUT"===children.tagName){let checkbox=children;checkbox.checked&&checkedQuestions.push(parseInt(checkbox.id))}return checkedQuestions}();if(0===questionIds.length)return void alert("No questions selected. Pleas choose at least one question to import.");!function(quizId,questionIds,lecturerId,quizUrl){(0,_repository.externalReuseQuestions)(quizId,questionIds,lecturerId).then((questions=>{let updateEventListeners=()=>{(0,_edit_question.addEditQuestionListeners)(quizId,lecturerId),(0,_delete_question.addDeleteQuestionListeners)(quizId,lecturerId)};(0,_helper.rerenderSavedQuestionsList)(questions,updateEventListeners),(0,_helper.rerenderTakeQuizButton)(quizUrl,!0)})).catch((error=>alert(error))),document.querySelector(".backdrop").remove()}(quizId,questionIds,lecturerId,quizUrl)}catch(error){alert("Error in import of questions",error)}}))}(quizId,url,lecturerId),(0,_helper.addCancelEditButtonListener)("import"),function(lecturerId,quizId){(0,_repository.getLecturerQuiz)(lecturerId).then((oldQuizzes=>{oldQuizzes=oldQuizzes.filter((currentQuiz=>currentQuiz.quizid!==quizId));let oldQuizzesContainer=document.querySelector(".old_quizzes");if(0===oldQuizzes.length){let noQuestions=document.createElement("p");return noQuestions.textContent="No questions available.",void oldQuizzesContainer.appendChild(noQuestions)}oldQuizzes.forEach((quiz=>{if(quiz.questions.length>0){let questionCheckboxes=[],quizDiv=document.createElement("div"),quizCheckbox=document.createElement("input");quizCheckbox.type="checkbox",quizCheckbox.value=quiz.quizid,quizCheckbox.id=quiz.quizid,quizCheckbox.style.marginRight="5px",quizCheckbox.name=quiz.quiztitle;let quizLabel=document.createElement("label");quizLabel.htmlFor="quiz_".concat(quiz.quizid),quizLabel.textContent=quiz.quiztitle,quizLabel.style.fontWeight="bold",quizDiv.class="oldquiz",quizDiv.appendChild(quizCheckbox),quizDiv.appendChild(quizLabel),quizDiv.style.border="2px solid black";let questionsDiv=document.createElement("div");questionsDiv.style.marginBottom="20px",questionsDiv.style.marginLeft="20px",questionsDiv.id="questionsdiv",quiz.questions.forEach((question=>{let questionDiv=document.createElement("div"),questionCheckbox=document.createElement("input");questionCheckbox.type="checkbox",questionCheckbox.value="question_".concat(question.questionid),questionCheckbox.style.marginRight="5px",questionCheckbox.id=question.questionid,questionCheckbox.name=question.questiontitle,questionCheckboxes.push(questionCheckbox);let questionLabel=document.createElement("label");questionLabel.htmlFor="question_".concat(question.questionid),questionLabel.textContent=question.questiontitle,questionDiv.appendChild(questionCheckbox),questionDiv.appendChild(questionLabel),questionsDiv.appendChild(questionDiv)})),function(checkbox,questionCheckboxes){checkbox.addEventListener("change",(()=>{questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.checked=checkbox.checked}))}))}(quizCheckbox,questionCheckboxes),function(checkbox,questionCheckboxes){questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.addEventListener("change",(()=>{if(questionCheckbox.checked){questionCheckboxes.every((question=>question.checked))&&(checkbox.checked=questionCheckbox.checked)}else checkbox.checked=questionCheckbox.checked}))}))}(quizCheckbox,questionCheckboxes),quizDiv.appendChild(questionsDiv),oldQuizzesContainer.appendChild(quizDiv)}}))})).catch((error=>alert(error)))}(lecturerId,quizId)})).catch((error=>alert(error)))}(quizId,lecturerId,url)}))}}));

//# sourceMappingURL=import_question.min.js.map