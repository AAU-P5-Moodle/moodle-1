define("mod_livequiz/import_question",["exports","core/templates","core/notification","./edit_question_helper","./edit_question","./delete_question","./repository"],(function(_exports,_templates,_notification,_edit_question_helper,_edit_question,_delete_question,_repository){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=async(quizId,lecturerId,url)=>{document.getElementById("id_buttonimportquestion").addEventListener("click",(()=>{!function(quizId,lecturerId,url){document.querySelector(".Modal_div")||_templates.default.renderForPromise("mod_livequiz/import_question_popup").then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main-container",html,js),function(quizId,url,lecturerId){let quizUrl=url;document.querySelector(".import_btn").addEventListener("click",(async()=>{try{let questionIds=function(){let checkedquestions=[];return document.querySelectorAll(".question_checkbox").forEach((question=>{question.checked&&checkedquestions.push(parseInt(question.id))})),checkedquestions}();if(0===questionIds.length)return void alert("No questions selected. Please choose at least one question to import.");!function(quizId,questionIds,lecturerId,quizUrl){(0,_repository.external_reuse_questions)(quizId,questionIds,lecturerId).then((questions=>{let update_event_listeners=()=>{(0,_edit_question.add_edit_question_listeners)(quizId,lecturerId),(0,_delete_question.add_delete_question_listeners)(quizId,lecturerId)};(0,_edit_question_helper.rerender_saved_questions_list)(questions,update_event_listeners),(0,_edit_question_helper.rerender_take_quiz_button)(quizUrl,!0)})).catch((error=>(0,_notification.exception)(error))),document.querySelector(".backdrop").remove()}(quizId,questionIds,lecturerId,quizUrl)}catch(error){(0,_notification.exception)(error)}}))}(quizId,url,lecturerId),(0,_edit_question_helper.add_cancel_edit_button_listener)("import"),function(lecturerId,quizId){(0,_repository.get_lecturer_quiz)(lecturerId).then((oldQuizzes=>{oldQuizzes=oldQuizzes.filter((currentquiz=>currentquiz.quizid!==quizId));let oldQuizzesContainer=document.querySelector(".oldQuizzes");if(0===oldQuizzes.length){let noQuestions=document.createElement("p");return noQuestions.textContent="No questions available.",void oldQuizzesContainer.appendChild(noQuestions)}oldQuizzes.forEach((quiz=>{let quiz_context={quizid:quiz.quizid,quiztitle:quiz.quiztitle,questions:quiz.questions};quiz.questions.length>0&&_templates.default.renderForPromise("mod_livequiz/import_questions_list",quiz_context).then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents(".oldQuizzes",html,js),function(quizId){let quizCheckbox=document.querySelector(".quiz_"+quizId),questionCheckboxes=document.querySelectorAll(".quiz_"+quizId+"_question");quizCheckbox.addEventListener("change",(()=>{questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.checked=quizCheckbox.checked}))}))}(quiz.quizid),function(quizId){let quizCheckbox=document.querySelector(".quiz_"+quizId),questionCheckboxes=document.querySelectorAll(".quiz_"+quizId+"_question");questionCheckboxes.forEach((questionCheckbox=>{questionCheckbox.addEventListener("change",(()=>{if(questionCheckbox.checked){questionCheckbox.parentElement.classList.add("question_selected");let allChecked=!1;questions=questionCheckboxes,allChecked=Array.from(questions).every((question=>question.checked)),allChecked&&(quizCheckbox.checked=questionCheckbox.checked)}else{questionCheckbox.parentElement.classList.remove("question_selected"),quizCheckbox.checked=questionCheckbox.checked}var questions}))}))}(quiz.quizid),function(quizId){document.querySelectorAll(".question_entry_"+quizId).forEach((questionEntry=>{questionEntry.addEventListener("click",(()=>{let questionCheckbox=questionEntry.querySelector(".question_checkbox");questionCheckbox.checked=!questionCheckbox.checked,questionCheckbox.dispatchEvent(new Event("change"))}))}))}(quiz.quizid)})).catch((error=>(0,_notification.exception)(error)))}))})).catch((error=>(0,_notification.exception)(error)))}(lecturerId,quizId)})).catch((error=>(0,_notification.exception)(error)))}(quizId,lecturerId,url)}))}}));

//# sourceMappingURL=import_question.min.js.map