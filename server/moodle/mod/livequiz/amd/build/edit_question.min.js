define("mod_livequiz/edit_question",["exports","core/templates","./repository","./helper","./delete_question"],(function(_exports,_templates,_repository,_helper,_delete_question){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.addEditQuestionListeners=addEditQuestionListeners,_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};function addEditQuestionListeners(quizId,lecturerId){document.getElementById("saved_questions_list").addEventListener("click",(event=>{let target=event.target;if(target.classList.contains("edit-question-btn")||target.classList.contains("question_list_text")){let questionId=parseInt(target.dataset.id,10);!function(quizId,lecturerId,questionId){document.querySelector(".modal_div")||_templates.default.renderForPromise("mod_livequiz/question_menu_popup",{},"boost").then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main_container",html,js),(0,_repository.getQuestion)(quizId,questionId).then((question=>{!function(questionData){document.getElementById("question_title_id").value=questionData.questiontitle,document.getElementById("question_description_id").value=questionData.questiondescription,document.getElementById("question_explanation_id").value=questionData.questionexplanation,document.getElementById("question_type_checkbox_id").checked="radio"===questionData.questiontype;let answers=questionData.answers;for(let i=0;i<answers.length;i++)restoreAnswerDataInPopup(answers[i])}(question)})).catch((error=>window.console.log(error))),(0,_helper.addAnswerButtonEventListener)(),function(quizId,lecturerId,questionId){document.querySelector(".save_button").addEventListener("click",(()=>{!function(quizId,lecturerId,questionId){let questionData=(0,_helper.getQuestionData)(),savedQuestion={id:questionId,title:questionData.title,answers:(0,_helper.prepareAnswers)(),description:questionData.description,explanation:questionData.explanation,type:questionData.type};if(!(0,_helper.validateSubmission)(savedQuestion.answers))return;(0,_repository.saveQuestion)(savedQuestion,lecturerId,quizId).then((questions=>{const contextsavedquestions={questions:questions};document.querySelector("#saved_questions_list").remove(),_templates.default.renderForPromise("mod_livequiz/saved_questions_list",contextsavedquestions,"boost").then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents("#saved_questions_container",html,js),addEditQuestionListeners(quizId,lecturerId),(0,_delete_question.addDeleteQuestionListeners)(quizId,lecturerId)})).catch((error=>displayException(error)))})).catch((()=>alert("Cannot edit a question, since it already has participations"))),document.querySelector(".backdrop").remove()}(quizId,lecturerId,questionId)}))}(quizId,lecturerId,questionId),(0,_helper.addCancelEditButtonListener)("edit")})).catch((error=>window.console.log(error)))}(quizId,lecturerId,questionId)}}))}function restoreAnswerDataInPopup(answer){let answerContainer=(0,_helper.createAnswerContainer)(answer.answerid);answerContainer.querySelector(".answer_input").value=answer.answerdescription,answerContainer.querySelector(".answer_checkbox").checked=answer.answercorrect,document.querySelector(".all_answers_for_question_div").appendChild(answerContainer)}_exports.init=async(quizId,lecturerId)=>{addEditQuestionListeners(quizId,lecturerId)}}));

//# sourceMappingURL=edit_question.min.js.map