define("mod_livequiz/edit_question",["exports","core/templates","core/notification","./repository","./edit_question_helper","./delete_question"],(function(_exports,_templates,_notification,_repository,_edit_question_helper,_delete_question){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.add_edit_question_listeners=add_edit_question_listeners,_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};function add_edit_question_listeners(quizid,lecturerid){document.getElementById("saved_questions_list").addEventListener("click",(event=>{let target=event.target;if(target.classList.contains("edit-question-btn")||target.classList.contains("question-title")){let questionid=parseInt(target.dataset.id,10);!function(quizid,lecturerid,questionid){_templates.default.renderForPromise("mod_livequiz/question_menu_popup").then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(".main-container",html,js),(0,_repository.get_question)(quizid,questionid).then((question=>{!function(questiondata){document.getElementById("question_title_id").value=questiondata.questiontitle,document.getElementById("question_description_id").value=questiondata.questiondescription,document.getElementById("question_explanation_id").value=questiondata.questionexplanation;let answers=questiondata.answers;for(let i=0;i<answers.length;i++)restore_answer_data_in_popup(answers[i]);console.log("answers: ",answers)}(question)})),(0,_edit_question_helper.add_answer_button_event_listener)(),function(quizid,lecturerid,questionid){document.querySelector(".save_button").addEventListener("click",(()=>{!function(quizid,lecturerid,questionid){let question_input_title=document.getElementById("question_title_id"),question_indput_description=document.getElementById("question_description_id"),question_indput_explanation=document.getElementById("question_explanation_id"),questionTitle=question_input_title.value.trim(),questionDesription=question_indput_description.value.trim(),questionExplanation=question_indput_explanation.value.trim();if(!questionDesription)return void alert("Please enter a question description.");questionTitle||(questionTitle="Question");let answers=[],answers_div=document.querySelector(".all_answers_for_question_div");for(let i=0;i<answers_div.children.length;i++){let answertext=answers_div.children[i].querySelector(".answer_input").value.trim(),iscorrect=answers_div.children[i].querySelector(".answer_checkbox").checked;iscorrect=iscorrect?1:0,answers.push({description:answertext,correct:iscorrect,explanation:""})}let savedQuestion={id:questionid,title:questionTitle,answers:answers,description:questionDesription,explanation:questionExplanation};(0,_repository.save_question)(savedQuestion,lecturerid,quizid).then((questions=>{const contextsavedquestions={questions:questions};document.querySelector("#saved_questions_list").remove(),_templates.default.renderForPromise("mod_livequiz/saved_questions_list",contextsavedquestions).then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents("#saved-questions-container",html,js),add_edit_question_listeners(quizid,lecturerid),(0,_delete_question.add_delete_question_listeners)(quizid,lecturerid)})).catch((error=>(0,_notification.exception)(error)))})),document.querySelector(".Modal_div").remove()}(quizid,lecturerid,questionid)}))}(quizid,lecturerid,questionid),(0,_edit_question_helper.add_discard_question_button_listener)()})).catch((error=>(0,_notification.exception)(error)))}(quizid,lecturerid,questionid)}}))}function restore_answer_data_in_popup(answer){let answer_container=(0,_edit_question_helper.create_answer_container)(answer.answerid);answer_container.querySelector(".answer_input").value=answer.answerdescription,answer_container.querySelector(".answer_checkbox").checked=answer.answercorrect,document.querySelector(".all_answers_for_question_div").appendChild(answer_container)}_exports.init=async(quizid,lecturerid)=>{add_edit_question_listeners(quizid,lecturerid)}}));

//# sourceMappingURL=edit_question.min.js.map